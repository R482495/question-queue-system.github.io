<?php
// ファイルへのパス
$dataFile = 'data.txt';

// フォームから送信されたデータの処理
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $name = $_POST['name'] ?? '';
    $seat = $_POST['seat'] ?? '';

    // ファイルにデータを追記
    $data = "$name, $seat, 対応待ち\n";
    file_put_contents($dataFile, $data, FILE_APPEND);
}

// ファイルからデータを読み取り
$questions = [];
if (file_exists($dataFile)) {
    $lines = file($dataFile, FILE_IGNORE_NEW_LINES);
    foreach ($lines as $line) {
        $question = explode(', ', $line);
        $questions[] = $question;
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>質問順番待ちシステム</title>
</head>
<body>
    <h1>質問順番待ちシステム</h1>

    <!-- Form to add a new question -->
    <form method="post">
        <label for="name">名前:</label>
        <input type="text" id="name" name="name" required=""><br><br>
        <label for="seat">座席:</label>
        <input type="text" id="seat" name="seat" required=""><br><br>
        <button type="submit">質問する</button>
    </form>

    <!-- Display of question queue -->
    <h2>質問順番</h2>
    <table>
        <thead>
            <tr>
                <th>名前</th>
                <th>座席</th>
                <th>状態</th>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($questions as $question): ?>
            <tr>
                <td><?= $question[0] ?></td>
                <td><?= $question[1] ?></td>
                <td><?= $question[2] ?></td>
            </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
</body>
</html>
